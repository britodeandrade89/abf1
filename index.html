<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ABFIT</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#111827">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ABFIT">
    <link rel="apple-touch-icon" href="https://via.placeholder.com/192x192/991b1b/FFFFFF?text=AB">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@700&display=swap" rel="stylesheet">
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    <!-- Chart.js for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Leaflet.js for GPS Tracking -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


    <link rel="stylesheet" href="index.css">
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.26.0",
    "@capacitor/cli": "https://aistudiocdn.com/@capacitor/cli@^7.4.4"
  }
}
</script>
</head>

<body class="overscroll-none">

    <!-- ======================= SPLASH SCREEN ======================= -->
    <div id="splashScreen" class="w-full h-screen flex flex-col items-center justify-center">
        <div class="p-6 flex flex-col items-center">
            <!-- Container inline-flex obriga a largura a ser definida pelo conteúdo (Logo) -->
            <div class="inline-flex flex-col w-max">
                <!-- LOGO RECREATED WITH CSS -->
                <h1 class="abfit-logo-style text-8xl mb-1 leading-none">
                    <span class="part-ab">AB</span><span class="part-fit">FIT</span>
                </h1>
                <!-- Subtitulo ajustado: Fonte pequena (10px), flex justify-between para alinhar as bordas -->
                <p class="text-white text-[10px] font-bold uppercase w-full flex justify-between tracking-wider mt-1 opacity-90">
                    <span>Assessoria</span><span>em</span><span>Treinamentos</span><span>Físicos</span>
                </p>
            </div>
        </div>
        <div class="absolute bottom-8 text-center">
            <p class="text-gray-400 text-sm">Desenvolvido por André Brito</p>
            <p class="text-gray-500 text-xs mt-1">Versão 1.2</p>
        </div>
    </div>

    <!-- ======================= PWA INSTALL BANNER ======================= -->
    <div id="pwa-install-banner" class="hidden fixed bottom-0 left-0 right-0 z-[60] bg-gray-900 border-t-2 border-red-600 p-4 shadow-2xl transition-transform duration-300 transform translate-y-0">
        <div class="flex items-center justify-between max-w-lg mx-auto">
             <div class="flex items-center gap-3">
                <div class="bg-gradient-to-br from-red-600 to-red-800 text-white font-black p-2 rounded-lg shadow-lg border border-red-500">AB</div>
                <div>
                    <h4 class="font-bold text-white text-sm">Instalar App ABFIT</h4>
                    <p class="text-xs text-gray-400">Acesso rápido na tela inicial</p>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button id="pwa-install-btn" class="bg-white text-black font-bold text-xs py-2 px-3 rounded-lg hover:bg-gray-200 transition shadow-md">
                    Instalar
                </button>
                <button id="pwa-close-btn" class="text-gray-400 hover:text-white p-1">
                    <i data-feather="x" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- ======================= APP CONTAINER ======================= -->
    <div id="appContainer" class="hidden init-hidden h-screen flex flex-col max-w-lg mx-auto">
        <main class="flex-grow screens-wrapper">
             <!-- ======================= TELA DE LOGIN ======================= -->
            <div id="loginScreen" class="screen p-6 flex flex-col justify-center">
                <div class="text-center mb-8 flex justify-center">
                    <div class="inline-block">
                        <!-- LOGO RECREATED WITH CSS -->
                        <h1 class="abfit-logo-style text-7xl mb-2">
                            <span class="part-ab">AB</span><span class="part-fit">FIT</span>
                        </h1>
                    </div>
                </div>
                <div class="bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-xl">
                    <h3 class="text-white font-bold text-xl mb-4 text-center">Acesse seu Perfil</h3>
                    <form id="login-form">
                        <div class="mb-4">
                            <label for="login-email" class="block text-sm font-medium text-white mb-1">Email</label>
                            <input type="email" id="login-email" required placeholder="seuemail@exemplo.com"
                                class="w-full p-3 border border-gray-600 bg-gray-700 text-white rounded-lg focus:ring-red-500 focus:border-red-500">
                        </div>
                        <button id="login-btn" type="submit"
                            class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl flex items-center justify-center space-x-2 transition shadow-lg shadow-red-500/20">
                            Entrar
                        </button>
                        <div id="login-error" class="text-red-500 text-center text-sm mt-3 h-4"></div>
                    </form>
                </div>
            </div>

            <!-- ======================= TELA PERFIL DO ALUNO ======================= -->
            <div id="studentProfileScreen" class="screen p-6">
                <!-- Header Organizado -->
                <header class="flex flex-col pt-6 pb-2">
                    
                    <!-- Linha Superior: Logo Centralizado + Clima à Direita -->
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex-1"></div> <!-- Espaçador para centralizar o logo -->
                        
                        <div class="flex-none animate-logo-entry">
                             <!-- LOGO RECREATED WITH CSS -->
                            <h1 class="abfit-logo-style text-6xl">
                                <span class="part-ab">AB</span><span class="part-fit">FIT</span>
                            </h1>
                        </div>

                        <div class="flex-1 flex flex-col items-end">
                             <div id="weather-widget" class="text-right flex flex-col items-end min-h-[50px] justify-center">
                                <!-- Populated by JS -->
                                <span class="text-xs text-gray-500">Carregando...</span>
                            </div>
                             <button id="logout-btn" class="mt-2 p-1 rounded-full hover:bg-gray-700 text-gray-400 hover:text-white border border-transparent hover:border-gray-600">
                                <i data-feather="log-out" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Faixa de Informações do Aluno Restaurada -->
                    <div id="student-profile-info" class="hidden bg-gray-800/80 backdrop-blur-md border border-gray-700 rounded-xl p-4 flex items-center gap-4 shadow-lg">
                        <!-- Injetado via JS -->
                    </div>

                </header>

                <div id="student-profile-buttons" class="grid grid-cols-3 gap-4 mb-6 mt-4"></div>

                <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                    <div id="calendar-header" class="flex justify-between items-center mb-4">
                        <button id="prev-month-btn" class="p-2 rounded-full hover:bg-gray-700"><i
                                data-feather="chevron-left" class="text-white"></i></button>
                        <h2 id="calendar-month-year" class="font-bold text-lg text-white">Carregando...</h2>
                        <button id="next-month-btn" class="p-2 rounded-full hover:bg-gray-700"><i
                                data-feather="chevron-right" class="text-white"></i></button>
                    </div>
                    <div class="grid grid-cols-7 gap-1 text-center text-xs text-white mb-2">
                        <div>D</div>
                        <div>S</div>
                        <div>T</div>
                        <div>Q</div>
                        <div>Q</div>
                        <div>S</div>
                        <div>S</div>
                    </div>
                    <div id="calendar-grid" class="grid grid-cols-7 gap-1 text-center text-sm"></div>
                </div>

                <div id="training-history-container" class="mt-6">
                    <!-- Training history will be rendered here by JS -->
                </div>
                
                <!-- FOOTER DETALHADO -->
                <footer class="mt-10 pb-24 pt-6 border-t border-gray-800 bg-transparent rounded-t-3xl -mx-6 px-6">
                    <div class="grid grid-cols-2 gap-y-6 gap-x-4 mb-6">
                        <div>
                            <h4 class="text-white font-bold text-xs mb-3 uppercase tracking-wider text-red-500">ABFIT</h4>
                            <ul class="space-y-2">
                                <li><a href="https://www.instagram.com" target="_blank" class="text-gray-500 text-[10px] hover:text-white transition-colors">Sobre nós</a></li>
                                <li><a href="https://www.linkedin.com" target="_blank" class="text-gray-500 text-[10px] hover:text-white transition-colors">Carreiras</a></li>
                                <li><a href="https://g1.globo.com" target="_blank" class="text-gray-500 text-[10px] hover:text-white transition-colors">Imprensa</a></li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-white font-bold text-xs mb-3 uppercase tracking-wider text-red-500">Ajuda</h4>
                            <ul class="space-y-2">
                                <li><a href="mailto:britodeandrade@gmail.com" class="text-gray-500 text-[10px] hover:text-white transition-colors">Fale Conosco</a></li>
                                <li><a href="https://wa.me/5521994527694" target="_blank" class="text-gray-500 text-[10px] hover:text-white transition-colors">Suporte</a></li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-white font-bold text-xs mb-3 uppercase tracking-wider text-red-500">Termos</h4>
                            <ul class="space-y-2">
                                <li><a href="https://policies.google.com/privacy?hl=pt-BR" target="_blank" class="text-gray-500 text-[10px] hover:text-white transition-colors">Política de Privacidade</a></li>
                                <li><a href="https://policies.google.com/terms?hl=pt-BR" target="_blank" class="text-gray-500 text-[10px] hover:text-white transition-colors">Termos e Condições</a></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="border-t border-gray-800 pt-6">
                        <div class="flex flex-col text-center space-y-4">
                            <div class="text-[10px] text-gray-500 space-y-1">
                                <p class="text-gray-300 font-medium">Desenvolvido por: <span class="text-white font-bold">André Brito</span></p>
                                <p class="text-gray-600">Versão: 1.2</p>
                                <div class="mt-2 pt-2 border-t border-gray-800/50">
                                    <p class="text-gray-500">Contato: britodeandrade@gmail.com</p>
                                    <p class="text-gray-500">+55 21 994 527 694</p>
                                </div>
                            </div>
                            <p class="text-[10px] text-gray-700 mt-2">© 2025 ABFIT Inc.</p>
                        </div>
                    </div>
                </footer>
            </div>

            <!-- ======================= TELA DE TREINO ======================= -->
            <div id="trainingScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <div class="text-center timer-header-box">
                        <h1 id="training-title" class="text-xl font-bold text-white uppercase tracking-wider">Treino</h1>
                        <div id="workout-timer" class="digital-timer text-4xl">00:00:00</div>
                    </div>
                    <button id="save-training-btn" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg text-sm flex items-center gap-2 shadow-lg">
                        <i data-feather="check-circle" class="w-4 h-4"></i>
                        <span>Concluir</span>
                    </button>
                </header>
                <div id="periodization-notification" class="hidden mb-4"></div>
                <div id="training-content-wrapper" class="space-y-3 pb-24"></div>
            </div>
            
            <!-- ======================= TELA DE PERIODIZAÇÃO ======================= -->
            <div id="periodizationScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Periodização</h1>
                    <div class="w-10"></div>
                </header>
                <div id="periodization-content-wrapper" class="space-y-4 pb-24">
                    <!-- Periodization table will be rendered here by JS -->
                </div>
            </div>

            <!-- ======================= TELA DE ANÁLISE IA ======================= -->
            <div id="aiAnalysisScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen">
                        <i data-feather="arrow-left" class="text-white"></i>
                    </button>
                    <h1 class="text-2xl font-bold text-white">Análise de Performance</h1>
                    <div class="w-10"></div>
                </header>
                <div class="space-y-4 pb-24 text-center">
                    <div class="bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg">
                        <i data-feather="cpu" class="w-16 h-16 mx-auto mb-4 text-teal-400"></i>
                        <h2 class="text-xl font-bold text-white mb-2">Análise com IA</h2>
                        <p class="text-sm mb-6">Receba insights sobre sua evolução de cargas e descubra pontos de melhoria.</p>
                        <button id="generate-analysis-btn" class="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 rounded-xl flex items-center justify-center space-x-2 transition shadow-lg">
                            <i data-feather="bar-chart-2"></i> <span>Gerar Análise</span>
                        </button>
                    </div>
            
                    <div id="ai-analysis-spinner" class="hidden text-center p-8">
                        <div class="loader inline-block"></div>
                        <p class="mt-4 text-white">Analisando seu progresso...</p>
                    </div>
            
                    <div id="ai-analysis-result" class="prose prose-invert max-w-none hidden text-left bg-gray-800 p-6 rounded-xl border border-gray-700 space-y-4">
                        <!-- AI results will be injected here -->
                    </div>
                </div>
            </div>

             <!-- ======================= TELA NUTRICIONISTA IA ======================= -->
            <div id="iaNutritionistScreen" class="screen flex flex-col p-0">
                <header class="flex items-center justify-between pt-6 pb-4 px-6 flex-shrink-0">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen">
                        <i data-feather="arrow-left" class="text-white"></i>
                    </button>
                    <h1 class="text-2xl font-bold text-white text-center">Consulta Nutricional IA</h1>
                    <div class="w-10"></div>
                </header>
                <div id="nutrition-content-wrapper" class="flex-grow overflow-y-auto">
                    <!-- O conteúdo da consulta (perguntas ou plano) será renderizado aqui -->
                </div>
            </div>


            <!-- ======================= TELA DE CORRIDA ======================= -->
            <div id="runningScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Treinos de Corrida</h1>
                    <div class="w-10"></div>
                </header>
                <div id="running-workouts-list" class="space-y-3 pb-24"></div>
            </div>

             <!-- ======================= TELA CALENDÁRIO DE CORRIDAS ======================= -->
            <div id="raceCalendarScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Provas de Corrida</h1>
                    <div class="w-10"></div>
                </header>
                <div class="bg-blue-900/50 text-blue-200 text-sm p-3 rounded-lg border border-blue-700 mb-4">
                    <p><strong>Aviso:</strong> Esta é uma lista de exemplo e pode não estar 100% atualizada. Sempre confirme os detalhes no site oficial do evento.</p>
                </div>
                <div id="race-calendar-list" class="space-y-4 pb-24">
                    <!-- Race calendar content will be rendered here by JS -->
                </div>
            </div>
            
            <!-- ======================= TELA BIBLIOTECA DE EXERCÍCIOS ======================= -->
            <div id="exerciciosScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Biblioteca de Exercícios</h1>
                    <div class="w-10"></div>
                </header>
                 <div class="mb-4 sticky top-0 bg-black/50 backdrop-blur-sm py-2 -mx-6 px-6 z-10">
                     <input type="text" id="exercise-search-input" placeholder="Buscar exercício..." class="w-full p-3 border border-gray-600 bg-gray-700 text-white rounded-lg focus:ring-red-500 focus:border-red-500">
                </div>
                <div id="exercise-library-list" class="grid grid-cols-2 gap-4 pb-24">
                    <!-- Exercise cards will be rendered here -->
                </div>
            </div>

            <!-- ======================= TELA DE EVOLUÇÃO ======================= -->
            <div id="evolutionScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Evolução de Carga</h1>
                    <div class="w-10"></div>
                </header>
                <div class="space-y-6 pb-24">
                    <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                        <h2 class="text-xl font-bold text-white mb-2">Treino A</h2>
                        <label for="select-treino-a" class="text-sm text-white mb-2 block">Selecione o Exercício</label>
                        <select id="select-treino-a" class="w-full p-3 border border-gray-600 bg-gray-700 text-white rounded-lg mb-4"></select>
                        <canvas id="treinoAChart" class="w-full"></canvas>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                        <h2 class="text-xl font-bold text-white mb-2">Treino B</h2>
                         <label for="select-treino-b" class="text-sm text-white mb-2 block">Selecione o Exercício</label>
                        <select id="select-treino-b" class="w-full p-3 border border-gray-600 bg-gray-700 text-white rounded-lg mb-4"></select>
                        <canvas id="treinoBChart" class="w-full"></canvas>
                    </div>
                </div>
            </div>

            <!-- ======================= TELA CONTROLE DE PESO ======================= -->
            <div id="weightControlScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Controle de Peso</h1>
                    <div class="w-10"></div>
                </header>
                <div class="space-y-4 pb-24">
                    <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                        <h2 class="text-xl font-bold text-white mb-4">Adicionar Novo Registro</h2>
                        <div class="flex items-center gap-2">
                            <input type="number" step="0.1" id="weight-input" inputmode="decimal" placeholder="Ex: 85.5"
                                class="w-full p-3 border border-gray-600 bg-gray-700 text-white rounded-lg">
                            <span class="font-semibold text-white">kg</span>
                            <button id="save-weight-btn"
                                class="bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition-colors shadow-lg">Salvar</button>
                        </div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                        <h2 class="text-xl font-bold text-white mb-4">Evolução do Peso</h2>
                        <canvas id="weightChart" class="w-full"></canvas>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                        <h2 class="text-xl font-bold text-white mb-4">Histórico de Peso</h2>
                        <div id="weight-history-list" class="space-y-2"></div>
                    </div>
                </div>
            </div>

            <!-- ======================= TELA AVALIAÇÃO FÍSICA ======================= -->
            <div id="physioAssessmentScreen" class="screen p-6">
                <header class="flex items-center pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                </header>
                 <header class="mb-8">
                    <h1 class="text-4xl font-bold text-white mb-2">
                        <i class="fas fa-dumbbell text-blue-400"></i> Avaliação Física
                    </h1>
                    <p class="text-gray-300">Sua plataforma de gestão de avaliações físicas.</p>
                    <nav class="mt-6 border-b border-gray-700">
                        <div class="flex space-x-8">
                            <button id="tab-professor" class="py-4 px-1 border-b-2 font-medium text-lg border-transparent text-gray-400 hover:text-blue-400 focus:outline-none tab-active">
                                <i class="fas fa-user-tie mr-2"></i> Professor
                            </button>
                            <button id="tab-aluno" class="py-4 px-1 border-b-2 font-medium text-lg border-transparent text-gray-400 hover:text-blue-400 focus:outline-none">
                                <i class="fas fa-user-graduate mr-2"></i> Aluno
                            </button>
                        </div>
                    </nav>
                </header>
                <main>
                    <!-- VISÃO DO PROFESSOR -->
                    <div id="view-professor">
                        <!-- Lista de Alunos e Ações -->
                        <div id="professor-dashboard">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-semibold text-white">Painel do Professor</h2>
                                <button id="btn-add-aluno" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">
                                    <i class="fas fa-user-plus mr-2"></i> Adicionar Aluno
                                </button>
                            </div>

                            <div id="loader" class="text-center p-8">
                                <i class="fas fa-spinner fa-spin text-4xl text-blue-400"></i>
                                <p class="mt-2 text-gray-300">Carregando alunos...</p>
                            </div>
                            
                            <div id="lista-alunos" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <!-- Cards de alunos serão inseridos aqui pelo JS -->
                            </div>
                            <div id="no-alunos-message" class="hidden text-center p-8 bg-gray-800 rounded-lg shadow-md">
                                <i class="fas fa-users-slash text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-semibold text-white">Nenhum aluno encontrado</h3>
                                <p class="text-gray-300">Adicione seu primeiro aluno para começar a registrar as avaliações.</p>
                            </div>
                        </div>

                        <!-- Formulário de Nova Avaliação -->
                        <div id="form-avaliacao" class="hidden">
                            <div class="flex items-center mb-6">
                                <button id="btn-back-to-dashboard" class="mr-4 bg-gray-700 hover:bg-gray-600 p-2 rounded-full"><i class="fas fa-arrow-left"></i></button>
                                <h2 class="text-2xl font-semibold text-white">Nova Avaliação para <span id="form-aluno-nome" class="text-blue-400"></span></h2>
                            </div>

                            <form id="avaliacao-form" class="space-y-8 bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                                <!-- Seção Dados Básicos -->
                                <fieldset class="grid grid-cols-1 md:grid-cols-3 gap-6 border-l-4 border-blue-500 pl-4">
                                    <legend class="text-xl font-bold mb-4 text-white">Dados Básicos</legend>
                                    <div><label for="data" class="block text-sm font-medium text-gray-300">Data da Avaliação</label><input type="date" id="data" required class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="peso" class="block text-sm font-medium text-gray-300">Peso Corporal (kg)</label><input type="number" step="0.1" id="peso" required class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="altura" class="block text-sm font-medium text-gray-300">Altura (cm)</label><input type="number" step="0.1" id="altura" required class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                </fieldset>

                                <!-- Seção Dobras Cutâneas (Protocolo Pollock 3) -->
                                <fieldset class="border-l-4 border-blue-500 pl-4">
                                    <legend class="text-xl font-bold mb-4 text-white">Dobras Cutâneas (mm) - Protocolo Pollock 3</legend>
                                    <div id="skinfold-fields-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        <!-- Campos dinâmicos baseados no sexo -->
                                        <div class="skinfold-field-wrapper" data-gender="Masculino"><label for="dc_peitoral" class="block text-sm font-medium text-gray-300">Peitoral</label><input type="number" step="0.1" id="dc_peitoral" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                        <div class="skinfold-field-wrapper" data-gender="Masculino"><label for="dc_abdominal" class="block text-sm font-medium text-gray-300">Abdominal</label><input type="number" step="0.1" id="dc_abdominal" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                        <div class="skinfold-field-wrapper" data-gender="Feminino"><label for="dc_tricipital" class="block text-sm font-medium text-gray-300">Tricipital</label><input type="number" step="0.1" id="dc_tricipital" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                        <div class="skinfold-field-wrapper" data-gender="Feminino"><label for="dc_suprailiaca" class="block text-sm font-medium text-gray-300">Suprailíaca</label><input type="number" step="0.1" id="dc_suprailiaca" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                        <div class="skinfold-field-wrapper" data-gender="Masculino Feminino"><label for="dc_coxa" class="block text-sm font-medium text-gray-300">Coxa</label><input type="number" step="0.1" id="dc_coxa" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    </div>
                                </fieldset>

                                <!-- Seção Perímetros -->
                                <fieldset class="grid grid-cols-2 md:grid-cols-4 gap-6 border-l-4 border-blue-500 pl-4">
                                    <legend class="text-xl font-bold mb-4 text-white">Perímetros (cm)</legend>
                                    <div><label for="p_torax" class="block text-sm font-medium text-gray-300">Tórax</label><input type="number" step="0.1" id="p_torax" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_abdomen" class="block text-sm font-medium text-gray-300">Abdômen</label><input type="number" step="0.1" id="p_abdomen" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_cintura" class="block text-sm font-medium text-gray-300">Cintura</label><input type="number" step="0.1" id="p_cintura" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_quadril" class="block text-sm font-medium text-gray-300">Quadril</label><input type="number" step="0.1" id="p_quadril" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_braco_d" class="block text-sm font-medium text-gray-300">Braço Direito</label><input type="number" step="0.1" id="p_braco_d" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_braco_e" class="block text-sm font-medium text-gray-300">Braço Esquerdo</label><input type="number" step="0.1" id="p_braco_e" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_antebraco_d" class="block text-sm font-medium text-gray-300">Antebraço Direito</label><input type="number" step="0.1" id="p_antebraco_d" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_antebraco_e" class="block text-sm font-medium text-gray-300">Antebraço Esquerdo</label><input type="number" step="0.1" id="p_antebraco_e" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_coxa_proximal_d" class="block text-sm font-medium text-gray-300">Coxa Proximal D (PX)</label><input type="number" step="0.1" id="p_coxa_proximal_d" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_coxa_proximal_e" class="block text-sm font-medium text-gray-300">Coxa Proximal E (PX)</label><input type="number" step="0.1" id="p_coxa_proximal_e" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_coxa_d" class="block text-sm font-medium text-gray-300">Coxa Medial Direita</label><input type="number" step="0.1" id="p_coxa_d" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_coxa_e" class="block text-sm font-medium text-gray-300">Coxa Medial Esquerda</label><input type="number" step="0.1" id="p_coxa_e" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_coxa_distal_d" class="block text-sm font-medium text-gray-300">Coxa Distal D (DT)</label><input type="number" step="0.1" id="p_coxa_distal_d" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_coxa_distal_e" class="block text-sm font-medium text-gray-300">Coxa Distal E (DT)</label><input type="number" step="0.1" id="p_coxa_distal_e" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_panturrilha_d" class="block text-sm font-medium text-gray-300">Panturrilha Direita</label><input type="number" step="0.1" id="p_panturrilha_d" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="p_panturrilha_e" class="block text-sm font-medium text-gray-300">Panturrilha Esquerda</label><input type="number" step="0.1" id="p_panturrilha_e" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                </fieldset>

                                <!-- Seção Bioimpedância -->
                                <fieldset class="grid grid-cols-2 md:grid-cols-4 gap-6 border-l-4 border-blue-500 pl-4">
                                    <legend class="text-xl font-bold mb-4 text-white">Bioimpedância</legend>
                                    <div><label for="bio_agua_corporal" class="block text-sm font-medium text-gray-300">Água Corporal (%)</label><input type="number" step="0.1" id="bio_agua_corporal" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_proteina" class="block text-sm font-medium text-gray-300">Proteína (%)</label><input type="number" step="0.1" id="bio_proteina" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_minerais" class="block text-sm font-medium text-gray-300">Minerais (%)</label><input type="number" step="0.1" id="bio_minerais" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_massa_gordura" class="block text-sm font-medium text-gray-300">Massa Gordura (kg)</label><input type="number" step="0.1" id="bio_massa_gordura" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_massa_magra" class="block text-sm font-medium text-gray-300">Massa Magra (kg)</label><input type="number" step="0.1" id="bio_massa_magra" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_tmb" class="block text-sm font-medium text-gray-300">TMB (kcal)</label><input type="number" id="bio_tmb" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_gordura_visceral" class="block text-sm font-medium text-gray-300">Gordura Visceral</label><input type="number" id="bio_gordura_visceral" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                    <div><label for="bio_grau_obesidade" class="block text-sm font-medium text-gray-300">Grau Obesidade (%)</label><input type="number" step="0.1" id="bio_grau_obesidade" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md py-2 px-3 text-white focus:ring-blue-500 focus:border-blue-500"></div>
                                </fieldset>

                                <div class="flex justify-end pt-4">
                                    <button type="submit" id="btn-salvar-avaliacao" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105">
                                        <i class="fas fa-save mr-2"></i> Salvar Avaliação
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Visualização de Dados do Aluno -->
                        <div id="view-aluno-data" class="hidden">
                            <!-- Conteúdo preenchido pelo JS -->
                        </div>
                    </div>

                    <!-- VISÃO DO ALUNO -->
                    <div id="view-aluno" class="hidden">
                        <div id="aluno-login-screen">
                            <h2 class="text-2xl font-semibold text-white mb-4">Selecione seu nome</h2>
                            <select id="aluno-selector" class="block w-full max-w-md bg-gray-800 border border-gray-700 rounded-md shadow-sm py-3 px-4 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <option>Carregando...</option>
                            </select>
                        </div>
                        <div id="aluno-dashboard" class="hidden">
                            <!-- Conteúdo do dashboard do aluno preenchido pelo JS -->
                        </div>
                    </div>
                </main>
            </div>

            <!-- ======================= INÍCIO DAS TELAS DE RASTREAMENTO OUTDOOR ======================= -->

            <!-- TELA DE SELEÇÃO DE ATIVIDADE OUTDOOR -->
            <div id="outdoorSelectionScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="outdoor-back-btn p-2 rounded-full hover:bg-gray-800"
                        data-target="studentProfileScreen"><i data-feather="arrow-left"
                            class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Treino Outdoor</h1>
                    <div class="w-10"></div>
                </header>
                <div class="p-4 bg-gray-800 text-center rounded-xl border border-gray-700 mb-6 shadow-lg">
                    <h2 class="text-xl font-bold text-white">ABFIT Outdoor</h2>
                    <p class="text-white">Sua jornada começa aqui. Escolha sua atividade.</p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <button
                        class="outdoor-activity-btn bg-gray-800 hover:bg-gray-700 border border-gray-700 text-white rounded-xl p-4 flex flex-col items-center justify-center space-y-2 h-32 transition shadow-md"
                        data-activity="Caminhada outdoor">
                        <i class="fas fa-walking text-3xl text-blue-400"></i>
                        <span class="font-semibold">Caminhada</span>
                    </button>
                    <button
                        class="outdoor-activity-btn bg-gray-800 hover:bg-gray-700 border border-gray-700 text-white rounded-xl p-4 flex flex-col items-center justify-center space-y-2 h-32 transition shadow-md"
                        data-activity="Corrida outdoor">
                        <i class="fas fa-running text-3xl text-orange-400"></i>
                        <span class="font-semibold">Corrida</span>
                    </button>
                    <button
                        class="outdoor-activity-btn bg-gray-800 hover:bg-gray-700 border border-gray-700 text-white rounded-xl p-4 flex flex-col items-center justify-center space-y-2 h-32 transition shadow-md"
                        data-activity="Ciclismo outdoor">
                        <i class="fas fa-biking text-3xl text-green-400"></i>
                        <span class="font-semibold">Ciclismo</span>
                    </button>
                    <button
                        class="outdoor-activity-btn bg-gray-800 hover:bg-gray-700 border border-gray-700 text-white rounded-xl p-4 flex flex-col items-center justify-center space-y-2 h-32 transition shadow-md"
                        data-activity="Natação outdoor">
                        <i class="fas fa-swimmer text-3xl text-cyan-400"></i>
                        <span class="font-semibold">Natação</span>
                    </button>
                </div>
            </div>

            <!-- TELA DE RASTREAMENTO DE ATIVIDADE -->
            <div id="outdoorTrackingScreen" class="screen p-6 flex flex-col">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="outdoor-back-btn p-2 rounded-full hover:bg-gray-800"
                        data-target="outdoorSelectionScreen"><i data-feather="arrow-left"
                            class="text-white"></i></button>
                    <h1 id="tracking-activity-title" class="text-2xl font-bold text-white">Atividade</h1>
                    <div class="w-10"></div>
                </header>
                <div class="map-container mb-4 shadow-lg border border-gray-600" id="map"></div>
                <div class="grid grid-cols-3 gap-4 mb-6 text-center">
                    <div class="bg-gray-800 p-4 rounded-xl shadow-md border border-gray-700">
                        <div class="text-sm">Distância</div>
                        <div id="tracking-distance" class="text-2xl font-bold">0.00 km</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-md border border-gray-700">
                        <div class="text-sm">Tempo</div>
                        <div id="tracking-time" class="text-2xl font-bold">00:00:00</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-md border border-gray-700">
                        <div class="text-sm">Ritmo</div>
                        <div id="tracking-pace" class="text-2xl font-bold">--:-- /km</div>
                    </div>
                </div>
                <div class="mt-auto flex items-center justify-center space-x-4 pb-24">
                    <button id="start-tracking-btn"
                        class="w-20 h-20 bg-green-600 hover:bg-green-700 text-white rounded-full flex items-center justify-center text-lg font-bold shadow-lg shadow-green-600/30 transform hover:scale-105 transition">
                        <i data-feather="play" class="w-8 h-8"></i>
                    </button>
                    <button id="pause-tracking-btn"
                        class="hidden w-20 h-20 bg-yellow-500 hover:bg-yellow-600 text-white rounded-full items-center justify-center text-lg font-bold shadow-lg shadow-yellow-500/30 transform hover:scale-105 transition">
                        <i data-feather="pause" class="w-8 h-8"></i>
                    </button>
                    <button id="stop-tracking-btn"
                        class="hidden w-20 h-20 bg-red-600 hover:bg-red-700 text-white rounded-full items-center justify-center text-lg font-bold shadow-lg shadow-red-600/30 transform hover:scale-105 transition">
                        <i data-feather="square" class="w-8 h-8"></i>
                    </button>
                </div>
            </div>

            <!-- ======================= TELAS NÍVEL DE ESTRESSE ======================= -->
            <!-- TELA PRINCIPAL NÍVEL DE ESTRESSE -->
            <div id="stressLevelScreen" class="screen p-6">
                <header class="flex items-center justify-between pt-6 pb-4">
                    <button class="back-btn p-2 rounded-full hover:bg-gray-800" data-target="studentProfileScreen"><i
                            data-feather="arrow-left" class="text-white"></i></button>
                    <h1 class="text-2xl font-bold text-white">Nível de Estresse</h1>
                    <div class="w-10"></div>
                </header>
                <div class="space-y-6 pb-24">
                     <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg">
                        <h2 class="text-xl font-bold text-white mb-4">Seu Nível de Estresse</h2>
                        <canvas id="stress-chart" class="w-full h-64"></canvas>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Modals -->
    <div id="exerciseDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4 modal">
        <div id="exercise-modal-content" class="bg-gray-800 rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto transform scale-95 opacity-0 modal-content border border-gray-700 shadow-2xl">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h2 id="modal-exercise-name" class="text-xl font-bold text-white pr-4">Nome do Exercício</h2>
                    <button id="closeExerciseModalBtn" class="text-gray-400 hover:text-white">
                        <i data-feather="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <div id="exercise-modal-body">
                    <img id="modal-exercise-img" src="" alt="Exercício" class="w-full h-48 object-cover rounded-lg mb-4 bg-gray-700">
                    
                    <div class="mb-4 exercise-details">
                        <h3 class="font-bold text-gray-300 mb-1">Método de Execução</h3>
                        <div id="modal-exercise-method" class="text-sm text-gray-400">
                            <p>Carregando...</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h3 class="font-bold text-gray-300 mb-2">Carga Atual (kg)</h3>
                        <form id="edit-carga-form" class="flex gap-2">
                            <input type="number" id="carga-input" class="w-full p-2 bg-gray-700 border border-gray-600 rounded text-white" placeholder="0">
                            <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded font-bold hover:bg-red-700 transition">Salvar</button>
                        </form>
                    </div>

                    <div>
                        <h3 class="font-bold text-gray-300 mb-2">Histórico de Carga</h3>
                        <div id="carga-history-list" class="space-y-2 max-h-40 overflow-y-auto pr-1">
                            <!-- Histórico aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
     <!-- Modal de Adicionar Aluno (Avaliação Física) -->
    <div id="modal-add-aluno" class="hidden fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4 transition-opacity">
        <div id="modal-content" class="bg-gray-800 rounded-lg shadow-xl w-full max-w-md transform scale-95 opacity-0 transition-transform duration-300 p-6 border border-gray-700">
            <h2 class="text-2xl font-bold text-white mb-4">Novo Aluno</h2>
            <form id="form-novo-aluno" class="space-y-4">
                <div>
                    <label for="nome-aluno" class="block text-sm font-medium text-gray-300">Nome Completo</label>
                    <input type="text" id="nome-aluno" required class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="nascimento-aluno" class="block text-sm font-medium text-gray-300">Data de Nascimento</label>
                    <input type="date" id="nascimento-aluno" required class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="sexo-aluno" class="block text-sm font-medium text-gray-300">Sexo</label>
                    <select id="sexo-aluno" class="mt-1 block w-full bg-gray-700 border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="Masculino">Masculino</option>
                        <option value="Feminino">Feminino</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="btn-cancel-modal" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Cancelar</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assessment.js"></script>
    <script type="module" src="index.js"></script>
</body>
</html>